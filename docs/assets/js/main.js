"use strict";console.log(">> Ready :)");let products=[],cart=[];const getApiData=()=>{fetch("./api/data.json").then(t=>t.json()).then(t=>{products=t.cart.items,paintProducts()})},productsElement=document.querySelector(".js-products"),cartElement=document.querySelector(".js-cart"),getProductHtmlCode=t=>{let e="";return e+='<article class="card">',e+=`<img src= "${t.imageUrl}" class="card__img" alt="Camiseta de ${t.name}">`,e+=`<h3 class="card__title">${t.name}</h3>`,e+=`<p class="card__description">${t.price} €</p>`,e+=`<button class="card__btn js-add-product" data-id= "${t.id}">Añadir a la cesta</button>`,e+="</article>",e};function paintProducts(){let t="";for(const e of products)t+=getProductHtmlCode(e);productsElement.innerHTML=t,listenAddProductsBtns()}function listenAddProductsBtns(){const t=document.querySelectorAll(".js-add-product");for(const e of t)e.addEventListener("click",handleIncProduct),console.log(e)}function findInArray(t,e){for(const n of e)if(n.id===t)return n}function findIndexInArray(t,e){for(let n=0;n<e.length;n+=1)if(e[n].id===t)return n}function handleIncProduct(t){console.log(products,t.target.dataset.id),console.log("me han clickado");const e=t.target.dataset.id;let n=findInArray(e,cart);if(void 0===n){let t=findInArray(e,products);console.log("Bien",t),cart.push({id:t.id,name:t.name,price:t.price,quantity:1})}else n.quantity+=1;console.log(cart),setInLocalStorage(),paintCartItems()}function handleDecProduct(t){const e=t.target.dataset.id;let n=findInArray(e,cart);if(console.log(n.quantity),n.quantity>1)n.quantity-=1;else{let t=findIndexInArray(e,cart);cart.splice(t,1)}console.log(n.quantity),console.log(t.target.dataset.id,"me han clickado"),setInLocalStorage(),paintCartItems()}function getCartItemHtmlCode(t){let e="";return e+="<tr>",e+=`<td>${t.name}</td>`,e+=`<td>${t.price}</td>`,e+="<td>",e+=`<button class="js-dec-btn card__btn" data-id="${t.id}">-</button>`,e+=""+t.quantity,e+=`<button class="js-inc-btn card__btn" data-id="${t.id}">+</button>`,e+=" </td>",e+=` <td class="text-align-right">${t.price*t.quantity}</td>`,e+=" </tr>",e}function getCartTotalHtmlCode(){let t="";return t+=' <tr class="text--bold">',t+="  <td>Total</td>",t+=`  <td colspan="3" class="text-align-right">\n        ${getTotalPrice()} €</td>`,t+="</tr>",t}function paintCartItems(){cartElement.innerHTML="";for(const t of cart)cartElement.innerHTML+=getCartItemHtmlCode(t);cartElement.innerHTML+=getCartTotalHtmlCode(),listenCartBtns()}function getTotalPrice(){let t=0;for(const e of cart)t+=e.price*e.quantity;return t}function listenCartBtns(){const t=document.querySelectorAll(".js-dec-btn");for(const e of t)e.addEventListener("click",handleDecProduct);const e=document.querySelectorAll(".js-inc-btn");for(const t of e)t.addEventListener("click",handleIncProduct)}function getFromLocalStorage(){const t=localStorage.getItem("cart");null!==t&&(cart=JSON.parse(t),paintCartItems())}fetch("./api/data.json").then(t=>t.json()).then(t=>{products=t.cart.items,paintProducts()}),paintCartItems();const setInLocalStorage=()=>{const t=JSON.stringify(cart);localStorage.setItem("cart",t)};getFromLocalStorage();const userAddress={},address=document.querySelector(".js-address"),city=document.querySelector(".js-city"),zip=document.querySelector(".js-zip");function handleAddress(t){const e=t.currentTarget.name;userAddress[e]=t.currentTarget.value,console.log("Dirección",userAddress),paintAddress()}function paintAddress(){document.querySelector(".js-address-info").innerHTML=`${userAddress.address||""} ${userAddress.city||""} ${userAddress.zip||""}`}address.addEventListener("keyup",handleAddress),city.addEventListener("keyup",handleAddress),zip.addEventListener("keyup",handleAddress);